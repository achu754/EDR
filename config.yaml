# EDR Agent Configuration

# Logging configuration
log_level: info  # trace, debug, info, warn, error

# Database settings
database:
  path: "./edr_events.db"

# JSONL logging
jsonl_log:
  enabled: true
  path: "./events.jsonl"

# Collector settings
collectors:
  # Process monitoring
  process:
    enabled: true
    # WMI polling interval in seconds (fallback if ETW unavailable)
    poll_interval: 5

  # Network monitoring
  network:
    enabled: true
    # Network connection polling interval in seconds
    poll_interval: 10

  # Persistence monitoring
  persistence:
    enabled: true
    # Filesystem and registry check interval in seconds
    poll_interval: 30
    # Paths to monitor
    watch_paths:
      - "C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"
      - "C:\\Users\\*\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"
    # Registry keys to monitor
    watch_registry:
      - "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
      - "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce"
      - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
      - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce"

# Hunt detection settings
hunts:
  enabled: true
  # Run hunts automatically on new events
  auto_hunt: true
